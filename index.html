<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>FNAF: Beginning of Hell</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <style>
        :root { --fnaf-red: #8b0000; }
        body { margin: 0; overflow: hidden; background: #050505; font-family: 'Courier New', Courier, monospace; color: white; user-select: none; }
        
        /* UI */
        #game-hud { position: fixed; inset: 0; z-index: 10; pointer-events: none; }
        #stats { position: fixed; top: 20px; left: 20px; font-size: 1.2rem; background: rgba(0,0,0,0.7); padding: 10px; border: 1px solid #333; }
        #btns { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); display: flex; gap: 10px; pointer-events: auto; }
        .game-btn { background: #111; color: white; border: 2px solid #444; padding: 15px 20px; cursor: pointer; font-weight: bold; text-transform: uppercase; }

        /* CÂMERAS */
        #cam-map { position: fixed; bottom: 100px; right: 20px; display: none; flex-direction: column; gap: 5px; pointer-events: auto; background: rgba(0,0,0,0.8); padding: 10px; border: 1px solid #ff0000; }
        .cam-btn { background: #222; color: white; border: 1px solid #666; padding: 8px; font-size: 12px; cursor: pointer; text-align: left; }
        .cam-btn:hover { background: #444; border-color: #fff; }

        /* INTERROGAÇÃO */
        #dialog-panel { position: fixed; bottom: 120px; left: 20px; background: rgba(0,0,0,0.9); border: 2px solid red; padding: 15px; display: none; flex-direction: column; gap: 10px; z-index: 20; width: 250px; pointer-events: auto; }
        .dialog-btn { background: #111; color: #ccc; border: 1px solid #444; padding: 8px; cursor: pointer; }
        
        /* EFEITOS */
        #static-fx { position: fixed; inset: 0; background: url('https://media.giphy.com/media/oEI9uWUqnW3Fe/giphy.gif'); opacity: 0.07; pointer-events: none; z-index: 5; display: none; }
        #cam-info { position: fixed; top: 20px; right: 20px; font-size: 1.5rem; color: red; display: none; font-weight: bold; }
    </style>
</head>
<body>

    <div id="static-fx"></div>
    <div id="cam-info">CAM 01</div>

    <div id="game-hud">
        <div id="stats">
            NOITE <span id="night-txt">1</span><br>
            <span id="hour-txt">12</span> AM<br>
            ENERGIA: <span id="pow-txt">100</span>%
        </div>

        <div id="cam-map">
            <button class="cam-btn" onclick="switchCam(0)">CAM 01 - CORREDOR</button>
            <button class="cam-btn" onclick="switchCam(1)">CAM 02 - SALA PRINCIPAL</button>
            <button class="cam-btn" onclick="switchCam(2)">CAM 03 - DEPÓSITO</button>
        </div>
        
        <div id="dialog-panel">
            <div style="color:red; margin-bottom:5px; font-size:10px;">INTERROGAÇÃO ATIVA</div>
            <button class="dialog-btn" onclick="askQuestion(0)">"Quem enviou você?"</button>
            <button class="dialog-btn" onclick="askQuestion(1)">"Por que não descansa?"</button>
        </div>

        <div id="btns">
            <button class="game-btn" onclick="toggleDoor()">PORTA</button>
            <button class="game-btn" onmousedown="toggleLight(true)" onmouseup="toggleLight(false)">LUZ</button>
            <button class="game-btn" onclick="toggleCamera()">MODO CAM</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>

    <script>
        /** ENGINE E CENA **/
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x020202);
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 100);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        /** ESTADOS **/
        let power = 100, night = 1, hour = 0;
        let doorClosed = false, cameraOpen = false, lightOn = false, isInterrogating = false;
        let currentCam = 0;

        /** LUZES (O SEGREDO PARA VER O CENÁRIO) **/
        const ambientLight = new THREE.AmbientLight(0x404040, 0.2); // Luz fraca constante
        scene.add(ambientLight);

        const officeLight = new THREE.PointLight(0xffffff, 0.8, 10);
        officeLight.position.set(0, 2, 4);
        scene.add(officeLight);

        const flashlight = new THREE.SpotLight(0xffffff, 0, 15, Math.PI/6, 0.5);
        flashlight.position.set(0, 1.5, 4);
        scene.add(flashlight);
        scene.add(flashlight.target);

        /** CONSTRUÇÃO DO CENÁRIO (VISÍVEL) **/
        const wallMat = new THREE.MeshStandardMaterial({ color: 0x222222, roughness: 0.8 });
        const floorMat = new THREE.MeshStandardMaterial({ color: 0x111111 });

        // Corredor (Onde tudo acontece)
        const hallGeo = new THREE.BoxGeometry(8, 5, 30);
        const hall = new THREE.Mesh(hallGeo, new THREE.MeshStandardMaterial({ color: 0x1a1a1a, side: THREE.BackSide }));
        hall.position.set(0, 2.5, -10);
        scene.add(hall);

        // Mesa de Segurança
        const desk = new THREE.Mesh(new THREE.BoxGeometry(4, 0.1, 1.5), new THREE.MeshStandardMaterial({color: 0x331100}));
        desk.position.set(0, 0.8, 4.5);
        scene.add(desk);

        // Porta
        const door = new THREE.Mesh(new THREE.BoxGeometry(2.5, 4, 0.2), new THREE.MeshStandardMaterial({color: 0x444}));
        door.position.set(-2.8, 2, 3);
        scene.add(door);

        /** ANIMATRÔNICO REALISTA **/
        const animatronic = new THREE.Group();
        const robotMat = new THREE.MeshStandardMaterial({color: 0x550000});
        const body = new THREE.Mesh(new THREE.BoxGeometry(0.8, 1.8, 0.6), robotMat);
        const head = new THREE.Mesh(new THREE.BoxGeometry(0.5, 0.6, 0.4), robotMat);
        head.position.y = 1.2;
        const eyeL = new THREE.Mesh(new THREE.SphereGeometry(0.05), new THREE.MeshBasicMaterial({color: 0xff0000}));
        eyeL.position.set(-0.15, 0.1, 0.2);
        const eyeR = eyeL.clone(); eyeR.position.x = 0.15;
        head.add(eyeL, eyeR);
        animatronic.add(body, head);
        animatronic.position.set(0, 0.9, -15);
        scene.add(animatronic);

        /** POSIÇÕES DAS CÂMERAS **/
        const camViews = [
            { pos: [0, 3, -2], look: [0, 1, -20], name: "CORREDOR" },
            { pos: [3, 4, -10], look: [-5, 0, -15], name: "SALA PRINCIPAL" },
            { pos: [-3, 3, -18], look: [0, 0, -10], name: "DEPÓSITO" }
        ];

        /** FUNÇÕES DO JOGO **/
        function toggleCamera() {
            if(power <= 0) return;
            cameraOpen = !cameraOpen;
            document.getElementById("static-fx").style.display = cameraOpen ? "block" : "none";
            document.getElementById("cam-map").style.display = cameraOpen ? "flex" : "none";
            document.getElementById("cam-info").style.display = cameraOpen ? "block" : "none";
            
            if(!cameraOpen) {
                camera.position.set(0, 1.6, 5.5);
                camera.lookAt(0, 1.6, -10);
            } else {
                switchCam(currentCam);
            }
        }

        function switchCam(idx) {
            currentCam = idx;
            const v = camViews[idx];
            camera.position.set(...v.pos);
            camera.lookAt(...v.look);
            document.getElementById("cam-info").innerText = v.name;
        }

        function toggleDoor() { if(power > 0) { doorClosed = !doorClosed; door.position.y = doorClosed ? 0.2 : 2; } }
        function toggleLight(on) { if(power > 0) { lightOn = on; flashlight.intensity = on ? 2.5 : 0; officeLight.intensity = on ? 1.2 : 0.6; } }

        function askQuestion(i) {
            isInterrogating = false;
            document.getElementById("dialog-panel").style.display = "none";
            animatronic.position.z = -18; // Afasta ele após a resposta
            if(cameraOpen) toggleCamera();
        }

        function update() {
            // Movimento do robô
            if(Math.random() < 0.002 && !isInterrogating) animatronic.position.z += 0.5;

            // Ativar Interrogação (Câmera 01 e Perto)
            if(cameraOpen && currentCam === 0 && animatronic.position.z > -8 && !isInterrogating) {
                isInterrogating = true;
                document.getElementById("dialog-panel").style.display = "flex";
            }

            // Consumo de energia
            if(power > 0) {
                power -= (doorClosed ? 0.05 : 0.01) + (cameraOpen ? 0.02 : 0);
                document.getElementById("pow-txt").innerText = Math.floor(power);
            } else {
                officeLight.intensity = 0;
                if(cameraOpen) toggleCamera();
            }

            // Jumpscare
            if(animatronic.position.z > 2.5 && !doorClosed) {
                alert("O ANIMATRÔNICO TE PEGOU!");
                location.reload();
            }
        }

        function animate() {
            requestAnimationFrame(animate);
            update();
            renderer.render(scene, camera);
        }

        // Setup Inicial
        camera.position.set(0, 1.6, 5.5);
        animate();

        window.addEventListener("resize", () => {
            camera.aspect = window.innerWidth/window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
