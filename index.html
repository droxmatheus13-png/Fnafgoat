<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>FNAF: Beginning of Hell</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <style>
        :root { --fnaf-red: #8b0000; --fnaf-gray: #222; }
        body { margin: 0; overflow: hidden; background: black; font-family: 'Courier New', Courier, monospace; color: white; user-select: none; }
        
        /* UI */
        #main-menu { position: fixed; inset: 0; background: black; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; transition: 1s; }
        h1 { font-size: 3rem; color: var(--fnaf-red); text-shadow: 2px 2px 10px red; text-align: center; }
        .menu-btn { background: none; border: none; color: white; font-size: 1.5rem; margin: 10px; cursor: pointer; letter-spacing: 3px; }

        #game-hud { display: none; position: fixed; inset: 0; z-index: 10; pointer-events: none; }
        #stats { position: fixed; top: 20px; left: 20px; font-size: 1.2rem; background: rgba(0,0,0,0.5); padding: 10px; }
        #btns { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); display: flex; gap: 10px; pointer-events: auto; }
        .game-btn { background: rgba(20,20,20,0.9); color: white; border: 2px solid #444; padding: 12px; cursor: pointer; font-weight: bold; }

        /* CAMERA SELECTOR */
        #cam-map { position: fixed; bottom: 100px; right: 20px; display: none; flex-direction: column; gap: 5px; pointer-events: auto; background: rgba(0,0,0,0.6); padding: 10px; border: 1px solid #555; }
        .cam-btn { background: #111; color: white; border: 1px solid #fff; padding: 5px; font-size: 10px; cursor: pointer; }
        .cam-btn:hover { background: #444; }

        /* INTERROGAÇÃO */
        #dialog-panel { position: fixed; bottom: 120px; left: 20px; background: rgba(0,0,0,0.9); border: 2px solid red; padding: 10px; display: none; flex-direction: column; gap: 5px; z-index: 20; width: 200px; pointer-events: auto; }
        .dialog-btn { background: #111; color: #ccc; border: 1px solid #444; padding: 5px; cursor: pointer; font-size: 12px; }
        
        #subtitles { position: fixed; top: 20%; left: 50%; transform: translateX(-50%); color: #f00; font-size: 1.5rem; display: none; z-index: 25; text-shadow: 2px 2px #000; text-align: center; width: 80%; }

        /* EFFECTS */
        #static { position: fixed; inset: 0; background: url('https://media.giphy.com/media/oEI9uWUqnW3Fe/giphy.gif'); opacity: 0.05; pointer-events: none; z-index: 5; display: none; }
        #vignette { position: fixed; inset: 0; background: radial-gradient(circle, transparent 40%, black 150%); pointer-events: none; z-index: 6; }
        #cam-label { position: fixed; top: 20px; right: 20px; font-size: 1.5rem; color: #fff; display: none; text-shadow: 2px 2px #000; }
    </style>
</head>
<body>

    <div id="static"></div>
    <div id="vignette"></div>
    <div id="cam-label">CAM 01</div>

    <div id="main-menu">
        <h1>FNAF:<br>BEGINNING OF HELL</h1>
        <button class="menu-btn" onclick="startGame()">NOVO JOGO</button>
    </div>

    <div id="game-hud">
        <div id="stats">
            <span id="night-txt">NOITE 1</span><br>
            <span id="hour-txt">12</span> AM<br>
            ENERGIA: <span id="pow-txt">100</span>%
        </div>

        <div id="cam-map">
            <button class="cam-btn" onclick="switchCam(0)">CAM 01 - CORREDOR</button>
            <button class="cam-btn" onclick="switchCam(1)">CAM 02 - SALA JANTAR</button>
            <button class="cam-btn" onclick="switchCam(2)">CAM 03 - DEPÓSITO</button>
        </div>
        
        <div id="dialog-panel">
            <button class="dialog-btn" onclick="askQuestion(0)">"Quem é você?"</button>
            <button class="dialog-btn" onclick="askQuestion(1)">"Por que está aqui?"</button>
        </div>
        <div id="subtitles">...</div>

        <div id="btns">
            <button class="game-btn" onclick="toggleDoor()">PORTA</button>
            <button class="game-btn" onmousedown="toggleLight(true)" onmouseup="toggleLight(false)" ontouchstart="toggleLight(true)" ontouchend="toggleLight(false)">LUZ</button>
            <button class="game-btn" onclick="toggleCamera()">MODO CAM</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>

    <script>
        /** CONFIGURAÇÃO **/
        let night = 1, hour = 0, power = 100, gameState = "MENU";
        let doorClosed = false, cameraOpen = false, lightOn = false;
        let isInterrogating = false, currentCam = 0;

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 100);
        const renderer = new THREE.WebGLRenderer({antialias: true});
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        const camPositions = [
            { pos: new THREE.Vector3(0, 3, -2), look: new THREE.Vector3(0, 0, -10), name: "CAM 01" }, // Corredor
            { pos: new THREE.Vector3(5, 4, -10), look: new THREE.Vector3(0, 0, -12), name: "CAM 02" }, // Sala Jantar
            { pos: new THREE.Vector3(-6, 3, -15), look: new THREE.Vector3(-2, 0, -14), name: "CAM 03" } // Depósito
        ];

        /** CENÁRIO AMPLIADO **/
        const wallMat = new THREE.MeshStandardMaterial({color: 0x151515});
        
        // Corredor Principal
        const hall = new THREE.Mesh(new THREE.BoxGeometry(6, 5, 40), wallMat);
        hall.position.set(0, 2.5, -10);
        hall.material = new THREE.MeshStandardMaterial({color: 0x111, side: THREE.BackSide});
        scene.add(hall);

        // Sala de Jantar (Canto)
        const room1 = new THREE.Mesh(new THREE.BoxGeometry(10, 6, 10), wallMat);
        room1.position.set(7, 3, -12);
        scene.add(room1);

        // Mesa de Segurança (Onde o jogador fica)
        const desk = new THREE.Mesh(new THREE.BoxGeometry(4, 0.8, 1.5), new THREE.MeshStandardMaterial({color: 0x221100}));
        desk.position.set(0, 0.4, 4);
        scene.add(desk);

        // Porta
        const door = new THREE.Mesh(new THREE.BoxGeometry(2.5, 4, 0.2), new THREE.MeshStandardMaterial({color: 0x333}));
        door.position.set(-2.8, 2, 2.5);
        scene.add(door);

        /** ANIMATRÔNICO (RED) **/
        const animatronic = new THREE.Group();
        const body = new THREE.Mesh(new THREE.BoxGeometry(0.8, 1.8, 0.6), new THREE.MeshStandardMaterial({color: 0x440000}));
        const head = new THREE.Mesh(new THREE.BoxGeometry(0.5, 0.6, 0.4), new THREE.MeshStandardMaterial({color: 0x660000}));
        head.position.y = 1.2;
        const eye = new THREE.Mesh(new THREE.SphereGeometry(0.05), new THREE.MeshBasicMaterial({color: 0xff0000}));
        const eyeL = eye.clone(); eyeL.position.set(-0.15, 0.1, 0.2);
        const eyeR = eye.clone(); eyeR.position.set(0.15, 0.1, 0.2);
        head.add(eyeL, eyeR);
        animatronic.add(body, head);
        animatronic.position.set(0, 0.9, -15);
        scene.add(animatronic);

        /** LUZES **/
        const officeLight = new THREE.PointLight(0xffffff, 0.5, 10);
        officeLight.position.set(0, 2.5, 3);
        scene.add(officeLight);

        const flashlight = new THREE.SpotLight(0xffffff, 0, 15, Math.PI/8);
        flashlight.position.set(0, 1.6, 3);
        scene.add(flashlight);
        scene.add(flashlight.target);

        /** LÓGICA CAMERAS **/
        function toggleCamera() {
            if(power <= 0) return;
            cameraOpen = !cameraOpen;
            document.getElementById("static").style.display = cameraOpen ? "block" : "none";
            document.getElementById("cam-map").style.display = cameraOpen ? "flex" : "none";
            document.getElementById("cam-label").style.display = cameraOpen ? "block" : "none";
            
            if(!cameraOpen) {
                // Volta para o Escritório
                camera.position.set(0, 1.6, 4.5);
                camera.lookAt(0, 1.6, -10);
            } else {
                switchCam(currentCam);
            }
        }

        function switchCam(index) {
            currentCam = index;
            const c = camPositions[index];
            camera.position.copy(c.pos);
            camera.lookAt(c.look);
            document.getElementById("cam-label").innerText = c.name;
            
            // Glitch visual ao trocar
            document.getElementById("static").style.opacity = "0.8";
            setTimeout(() => document.getElementById("static").style.opacity = "0.1", 100);
        }

        /** JOGO **/
        function startGame() {
            document.getElementById("main-menu").style.display = "none";
            document.getElementById("game-hud").style.display = "block";
            gameState = "PLAYING";
            camera.position.set(0, 1.6, 4.5);
        }

        function toggleDoor() { if(power > 0) { doorClosed = !doorClosed; door.position.y = doorClosed ? 0.2 : 2; } }
        function toggleLight(on) { if(power > 0) { lightOn = on; flashlight.intensity = on ? 2 : 0; } }

        function update() {
            if(gameState !== "PLAYING") return;

            // Movimento Animatrônico
            if(Math.random() < 0.001 * night && !isInterrogating) {
                animatronic.position.z += 0.5;
                // Move lateralmente para parecer que está explorando as salas
                if(animatronic.position.z < -10) animatronic.position.x = Math.sin(Date.now() * 0.001) * 4;
                else animatronic.position.x = 0;
            }

            // Sistema Interrogação na CAM 01 (Corredor)
            if(cameraOpen && currentCam === 0 && animatronic.position.z > -8 && !isInterrogating) {
                isInterrogating = true;
                document.getElementById("dialog-panel").style.display = "flex";
            }

            // Game Over
            if(animatronic.position.z > 2 && !doorClosed) {
                gameState = "GAMEOVER";
                alert("GAME OVER - O Animatrônico te pegou!");
                location.reload();
            }

            // Energia
            power -= (doorClosed ? 0.04 : 0.01) + (lightOn ? 0.03 : 0) + (cameraOpen ? 0.02 : 0);
            document.getElementById("pow-txt").innerText = Math.max(0, Math.floor(power));
            if(power <= 0) { officeLight.intensity = 0; toggleLight(false); doorClosed = false; door.position.y = 2; if(cameraOpen) toggleCamera(); }
        }

        function askQuestion(i) {
            document.getElementById("subtitles").innerText = i === 0 ? "Eu sou o que restou..." : "Para ver você sofrer.";
            document.getElementById("subtitles").style.display = "block";
            setTimeout(() => {
                document.getElementById("subtitles").style.display = "none";
                document.getElementById("dialog-panel").style.display = "none";
                isInterrogating = false;
                animatronic.position.z = -15; // Afasta ele
            }, 3000);
        }

        function animate() {
            requestAnimationFrame(animate);
            if(gameState === "PLAYING") {
                update();
                if(!cameraOpen) {
                    camera.rotation.y = Math.sin(Date.now() * 0.0005) * 0.1;
                }
            }
            renderer.render(scene, camera);
        }

        animate();

        window.addEventListener("resize", () => {
            camera.aspect = window.innerWidth/window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
